# Story 2.4: Unsafe Link UI Feedback

## Status

Draft

## Story

**As a** user,
**I want** to be clearly notified if my link is rejected for being unsafe,
**so that** I understand why it was blocked.

## Acceptance Criteria

1. When the API returns an "unsafe" error, the frontend displays a clear, non-alarming warning message.
2. The message explains that the link was flagged by a security check and cannot be shortened.

## Tasks / Subtasks

- [ ] Update Link Submission UI to Handle API Errors (AC: 1)
  - [ ] Modify the Link Submission UI component to receive API error responses
  - [ ] Implement conditional rendering based on the error type (e.g., `UNSAFE_URL_BLOCKED`)
  - [ ] Display a dedicated error message area on the UI

- [ ] Display Clear Warning Message (AC: 1, 2)
  - [ ] Craft a user-friendly, non-technical warning message for unsafe URLs
  - [ ] Ensure the message clearly states the reason for blocking (security check)
  - [ ] Use appropriate visual cues (e.g., warning icon, distinct color) for the message
  - [ ] Ensure the message is accessible (e.g., ARIA live regions)

- [ ] Prevent Form Submission on Unsafe Error
  - [ ] Disable the "Shorten" button or clear the input field after an unsafe error
  - [ ] Provide guidance on what the user can do next (e.g., try a different URL)

- [ ] User Experience Refinements
  - [ ] Ensure the error message is dismissible or disappears after a timeout
  - [ ] Maintain overall minimalist design principles even with error display
  - [ ] Provide clear focus management for accessibility

- [ ] Unit and Integration Testing
  - [ ] Test UI rendering with a simulated "unsafe" API error response
  - [ ] Verify the warning message content and styling
  - [ ] Test accessibility of the error message
  - [ ] Test that the form behaves correctly after an unsafe error

## Dev Notes

[Source: docs/prd/epic-list.md]
[Source: docs/prd/goals-and-background-context.md]
[Source: docs/stories/1.4.link-submission-ui.md]
[Source: docs/stories/2.3.integrate-security-check-into-link-creation.md]

**Frontend Integration:**

- The Link Submission UI (from Story 1.4) will be updated to display the feedback.
- The API error response from the `POST /api/shorten` endpoint (from Story 2.3) will drive the UI feedback.

**Expected API Error Response for Unsafe URL:**

```json
{
  "success": false,
  "error": {
    "code": "UNSAFE_URL_BLOCKED",
    "message": "The submitted URL was flagged as unsafe and cannot be shortened."
  }
}
```

**UI Design Considerations:**

- The warning message should be prominent but not intrusive.
- Use clear, concise language. Avoid jargon.
- Example message: "This link was flagged as potentially unsafe and cannot be shortened. Please try a different URL."
- Consider using a toast notification or an inline message near the input field.

**Accessibility:**

- Ensure the warning message is announced by screen readers.
- Provide sufficient color contrast for the message.
- Allow keyboard users to easily dismiss the message if it's a temporary notification.

**User Flow:**

1. User enters URL and clicks "Shorten".
2. API call is made.
3. API returns `UNSAFE_URL_BLOCKED` error.
4. UI displays warning message.
5. Input field remains, but user is prompted to try a different URL.

### Testing

Testing Requirements:

- Component tests for the Link Submission UI with various error states.
- End-to-end tests simulating an unsafe URL submission and verifying the UI feedback.
- Accessibility audits of the error message display.
- Usability testing to ensure the message is clear and helpful to users.

## Change Log

| Date       | Version | Description            | Author       |
| ---------- | ------- | ---------------------- | ------------ |
| 2024-03-14 | 1.0     | Initial story creation | Scrum Master |

## Dev Agent Record

### Agent Model Used

### Debug Log References

### Completion Notes List

### File List

## QA Results
